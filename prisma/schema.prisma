generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

enum Categoria {
  LANCHE
  BEBIDA
  SOBREMESA
  COMBO
}

enum PedidoStatus {
    ABERTO
    PAGO
    CANCELADO
}

model Usuario {
  id         String   @id @default(uuid())
  nome       String
  telefone   String   @unique
  email      String   @unique
  cpf        String   @unique
  cep        String
  logradouro String?
  bairro     String?
  localidade String?
  uf         String?
  ativo      Boolean  @default(true)
  pedidos    Pedido[]
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  @@map("usuarios")
}

model Produto {
  id         String       @id @default(uuid())
  nome       String
  descricao  String?
  categoria  Categoria
  preco      Decimal      @db.Decimal(10, 2)
  disponivel Boolean      @default(true)
  itens      ItemPedido[]
  createdAt  DateTime     @default(now())
  updatedAt  DateTime     @updatedAt

  @@map("produtos")
}

model Pedido {
    id        String       @id @default(uuid())
    cliente   Usuario      @relation(fields: [clienteId], references: [id])
    clienteId String
    total     Decimal      @db.Decimal(10, 2)
    status    PedidoStatus @default(ABERTO)
    criadoEm  DateTime     @default(now())
    itens     ItemPedido[]

    @@map("pedidos")
}

model ItemPedido {
  id         String  @id @default(uuid())
  quantidade Int
  precoUnit  Decimal @db.Decimal(10, 2)
  pedido     Pedido  @relation(fields: [pedidoId], references: [id])
  pedidoId   String
  produto    Produto @relation(fields: [produtoId], references: [id])
  produtoId  String

  @@map("itens_pedidos")
}
